<html lang="en">    

<title> Convert Excel File To JSON </title>

<head>
     <script src="js/jquery.js"> </script> 
    <script lang="javascript" src="js/xlsx.core.min.js"></script>
	<script lang="javascript" src="js/xlsx.full.min.js"></script>
	<script type="text/javascript" src="js/Chart.js"></script>

    <script>

    </script>
	
	

</head>

<body>
	<style type="text/css">
		body{
			font-family: roboto;
		}
	</style>
	<br><br><br><br>
	<input type="hidden" id="hidden" >
	<div style="width: 600px;height: 700px">
		<canvas id="myChart"></canvas>
	</div>
 
 
	<script>
	
	
	
	
	  var dt = "";
	  var url ="example_data.xlsx"
		var req = new XMLHttpRequest();
		req.open("GET", url, true);
		req.responseType = "arraybuffer";

		req.onload = function(e) {
		  var data = new Uint8Array(req.response);
		  
			var workbook = XLSX.read(data, {type:"array"});
		    var first_sheet_name = workbook.SheetNames[0];
			var worksheet = workbook.Sheets[first_sheet_name];
			dt = XLSX.utils.sheet_to_json(worksheet, {header:1});
			
			
			
		console.log('cnt dt  ',(dt.length));
		
		var ctx = document.getElementById("myChart").getContext('2d');
		
	
		var opts = '';
		for (var i = 1; i < dt.length-2; i++) {
			var opt = "";
			var selected = '';
           
			console.log(dt[i]);
			
			
			 opts = opts + "<option value='"+i+"'>"+dt[i][1]+"</options>";
			 
			 console.log($('#cbo_category').val());
			 
			 
						var myChart = new Chart(ctx, {
						type: 'bar',
						data: {
							labels: [ dt[i][2], parseInt(dt[i][3]-dt[i][2]), dt[i][3]],
							datasets: [{
								label: '',
								data: [ dt[i][2], parseInt(dt[i][3]-dt[i][2]), dt[i][3]],
								backgroundColor: [
								'silver',
								'green',
								'black'
								
								],
								borderColor: [
								'rgba(255,99,132,1)',
								'rgba(54, 162, 235, 1)',
								'rgba(255, 206, 86, 1)'
								
								],
								borderWidth: 1
							}]
						},
						options: {
							scales: {
								yAxes: [{
									ticks: {
										beginAtZero:true
									}
								}]
							}
						}
					});
			 
			 
			 
					
		}
		
		
		var select = "<select id='cbo_category'>"+opts+"</select>";
		$(select).insertAfter('#hidden');
		
	
		
	$('#cbo_category').change(function() {
   
			  console.log('dtttttt= ',dt)
			  
			   if( this.value == "1" ){
			   var datanya = [dt[1][2], parseInt(dt[1][3]-dt[1][2]), dt[1][3] ];
			   }
			   if( this.value == "2" ){
			   var datanya =  [dt[2][2], parseInt(dt[2][3]-dt[2][2]), dt[2][3] ];
			   }
			   if( this.value == "3" ){
			   var datanya =  [dt[3][2], parseInt(dt[3][3]-dt[3][2]), dt[3][3] ];
			   }
			   if( this.value == "4" ){
			   var datanya =  [dt[4][2], parseInt(dt[4][3]-dt[4][2]), dt[4][3] ];
			   }
			   if( this.value == "5" ){
			   var datanya =  [dt[5][2], parseInt(dt[5][3]-dt[5][2]), dt[5][3] ];
			   }
			   if( this.value == "6" ){
			   var datanya =  [dt[6][2], parseInt(dt[6][3]-dt[6][2]), dt[6][3] ];
			   }
			   if( this.value == "7" ){
			   var datanya =  [dt[7][2], parseInt(dt[7][3]-dt[7][2]), dt[7][3] ];
			   }
			   if( this.value == "8" ){
			   var datanya =  [dt[8][2], parseInt(dt[8][3]-dt[8][2]), dt[8][3] ];
			   }
			   if( this.value == "9" ){
			   var datanya =  [dt[9][2], parseInt(dt[9][3]-dt[2][2]), dt[9][3] ];
			   }
			   if( this.value == "10" ){
			   var datanya =  [dt[10][2], parseInt(dt[10][3]-dt[10][2]), dt[10][3] ];
			   }
			   if( this.value == "11" ){
			   var datanya =  [dt[11][2], parseInt(dt[11][3]-dt[11][2]), dt[11][3] ];
			   }
			   if( this.value == "12" ){
			   var datanya =  [dt[12][2], parseInt(dt[12][3]-dt[12][2]), dt[12][3] ];
			   }
			   
						var myChart = new Chart(ctx, {
						type: 'bar',
						data: {
							labels: datanya ,
							datasets: [{
								label: '',
								data:  datanya ,
								backgroundColor: [
								'silver',
								'green',
								'black'
								
								],
								borderColor: [
								'rgba(255,99,132,1)',
								'rgba(54, 162, 235, 1)',
								'rgba(255, 206, 86, 1)'
								
								],
								borderWidth: 1
							}]
						},
						options: {
							scales: {
								yAxes: [{
									ticks: {
										beginAtZero:true
									}
								}]
							}
						}
					});
				 
			});
		
			
		
		};
		req.send();
		
		
		
		
	</script>
</body>



</html>


